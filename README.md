# Catharanthus_multiome
Scripts used in Catharanthus multiome manuscript

## Single cell RNA-seq analysis 
"Multi_GEX_starsolo.Rmd" takes the output of [STARsolo](https://github.com/alexdobin/STAR/blob/master/docs/STARsolo.md) and creates Seurat objects. The script generates Fig. 1a-b, Fig. S2, Fig. S3, Fig. S4, and Fig. S8a-b.

## Single cell ATAC-seq analysis 
1. "cellranger-car_count_CRO*.sh" runs [cellranger-arc](https://www.10xgenomics.com/support/software/cell-ranger-arc/latest/algorithms-overview/algorithms-overview) to align ATAC-seq reads to the genome and generates peak x cell matrix for each replicate.

2. "ATAC_prepocessing_CRO*.Rmd" takes the output of cellranger-arc and creates Seurat objects. It also filters nuclei.

3. "ATAC_integration.Rmd" takes the output of "ATAC_prepocessing_CRO*.Rmd" and integrates them into a single Seurat object. Then, it integrates the ATAC Seurat object with the RNA Seurat object generated by "Multi_GEX_starsolo.Rmd".

4. "Split_fragments_to_clusters.Rmd" takes the fragment files (outputs from "cellranger-car_count_CRO*.sh") and writes a separate fragment file for each cell cluster. These cluster-level fragment files were used to call peaks with [MACS2](https://hbctraining.github.io/Intro-to-ChIPseq/lessons/05_peak_calling_macs.html). Peaks for each cell cluster were merged into a unified peak bed file. 

5. "metaplots_matrix.sh" runs [deeptools](https://deeptools.readthedocs.io/en/develop/) to generate Fig. S5, Fig. S6, and Fig. S7e.

6. The unified peak bed file from step 4 is used with "ATAC_integration.Rmd" to generate a multiome Seurat object and Fig. 1c.

## DAP-seq analysis 
1. "BWA_index_cro.sh" and "BWA_aln_CRO.sh"  were used to run [BWA](https://github.com/lh3/bwa) to index the genome and align DAP-seq reads to the genome. BAM files were then processed with "coverage_bedgraphs.sh" make "*.bedgraph" files for coverage plots.

2. "Mapping_metrics.Rmd" was used to generate Fig. S7a-d.

3. "ORCA_target_genes.Rmd" was used to generate Fig. 2a,b,d.

4. "cro_call_peaks.sh" was used to call DAP-seq peaks. DNA sequences of peaks were extracted with [BEDTools](https://bedtools.readthedocs.io/en/latest/content/bedtools-suite.html) and passed to "MEME.sh" to generate Fig. 2c.

## Cell type specific ATAC peak analysis 
1. "Peak_and_gene.Rmd" and "Coverage_plots.Rmd" were used to generate coverage plots shown in Fig. 3a-b, and Fig. S13e.

2. "JASPAR.Rmd" was used to identify cell type marker peaks and overrepresented motifs shown in Fig. 3c-d, and Fig. S9a.

## Gene co-expression analysis 
"GeneCoEx.Rmd" was used to generate Fig. 4 and Fig. S9b. 

## Bioinformatic analysis for WRKY and MYB candidates 
1. [MYB annotator](https://github.com/bpucker/MYB_annotator) was used to identify all MYB TFs in the Catharanthus genome. MYB domains from Catharanthus, potato, tomato, and Arabidopsis (part of MYB annotator output) was aligned with "mafft.sh".

2. The alignment file was passed onto "RxML.sh" to produce phylogeny with bootstrap support.

3. The phylogeny was processed with "CRO_MYBs.Rmd" to generate Fig. S10. "CRO_MYBs.Rmd" also re-analyze JA-induction datasets to generate Fig. S9c.

4. "Protoplast_RNAseq.Rmd" was used to generate Fig. S9d.

## Re-analysis of petal single cell RNA-seq data 
"Petal_pip_2.Rmd" was used to generate Fig. S11.

## TF overexpression analysis 
"TF_RNAseq.Rmd" was used to generate Fig. 5 and Fig. S12. 

## Pixel intensity quantification
"Pixel_intensities.Rmd" was used to analyze results of transactivation assays to generate Fig. 6i. 
